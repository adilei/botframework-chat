<!DOCTYPE html>
<html>
<head>
  <title>WebChat OOTB Test</title>
  <style>
    html, body { height: 100%; margin: 0; }
    #webchat { height: 100%; width: 100%; }
  </style>
</head>
<body>
  <div id="webchat"></div>

  <script src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js"></script>
  <script>
    const TOKEN_ENDPOINT = 'https://6cc0c98e3fe6e0d58ebaba51c9da1d.13.environment.api.powerplatform.com/powervirtualagents/botsbyschema/cr26e_booksSearch2/directline/token?api-version=2022-03-01-preview';

    (async function() {
      const response = await fetch(TOKEN_ENDPOINT);
      const { token } = await response.json();

      const directLine = window.WebChat.createDirectLine({ token });

      window.WebChat.renderWebChat(
        {
          directLine: directLine,
          styleOptions: {
            bubbleBackground: '#f0f0f0',
            bubbleFromUserBackground: '#0078d4',
            bubbleFromUserTextColor: '#ffffff',
          }
        },
        document.getElementById('webchat')
      );
    })();
  </script>
</body>
</html>
